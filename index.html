<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Kalp Toplama Oyunu</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      width: 100vw;
      height: 100vh;
      touch-action: none;
    }
    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }
    /* Butonlar için stil */
    .controlButton {
      position: absolute;
      bottom: 20px;
      padding: 15px;
      background-color: rgba(0, 0, 0, 0.5);
      color: white;
      font-size: 30px;
      border-radius: 50%;
      cursor: pointer;
    }
    #jumpButton {
      left: 50%;
      transform: translateX(-50%);
    }
    #leftButton {
      left: 20px;
    }
    #rightButton {
      right: 20px;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>

  <div id="jumpButton" class="controlButton">↑</div>
  <div id="leftButton" class="controlButton">←</div>
  <div id="rightButton" class="controlButton">→</div>

  <!-- Yüz resimleri -->
  <img id="face1" src="https://i.hizliresim.com/r6bm8a9.png" style="display: none;">
  <img id="face2" src="https://i.hizliresim.com/37shbzf.png" style="display: none;">

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let score = 0;
    let lives = 3;
    let gravity = 0.5;
    let jumpStrength = 12;
    let offsetY = 0; // Ekran kayma miktarı

    // Karakter özellikleri
    const character1 = {
      x: canvas.width / 2 - 60,
      y: canvas.height - 150 - offsetY,
      width: 40,
      height: 40,
      velX: 0,
      velY: 0,
      speed: 10, // Hız arttırıldı
      grounded: false
    };

    const character2 = {
      x: canvas.width / 2 + 20,
      y: canvas.height - 150 - offsetY,
      width: 40,
      height: 40,
      velX: 0,
      velY: 0,
      speed: 10, // Hız arttırıldı
      grounded: false
    };

    // Platformlar ve kalpler
    let platforms = [];
    let hearts = [];

    // Canvas boyutlarını ayarla
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resizeCanvas);
    resizeCanvas(); // Başlangıçta canvas boyutunu ayarla

    // Zıplama butonuna tıklama
    document.getElementById("jumpButton").addEventListener("click", () => {
      if (character1.grounded) {
        character1.velY = -jumpStrength;
        character1.grounded = false;
      }
      if (character2.grounded) {
        character2.velY = -jumpStrength;
        character2.grounded = false;
      }
    });

    // Sol ve sağ hareket butonlarına tıklama
    let moveLeft = false;
    let moveRight = false;

    let leftButtonActive = false;
    let rightButtonActive = false;

    document.getElementById("leftButton").addEventListener("mousedown", () => {
      if (!leftButtonActive) {
        moveLeft = true;
        leftButtonActive = true;
      }
    });

    document.getElementById("rightButton").addEventListener("mousedown", () => {
      if (!rightButtonActive) {
        moveRight = true;
        rightButtonActive = true;
      }
    });

    // Butonları bıraktığında hareketsizlik
    document.getElementById("leftButton").addEventListener("mouseup", () => {
      moveLeft = false;
      leftButtonActive = false;
    });

    document.getElementById("rightButton").addEventListener("mouseup", () => {
      moveRight = false;
      rightButtonActive = false;
    });

    // Platform oluşturma
    function createPlatform(yPosition) {
      const platform = {
        x: Math.random() * (canvas.width - 150),
        y: yPosition,
        width: 150,
        height: 20
      };
      platforms.push(platform);
    }

    // Kalp oluşturma
    function createHeart(yPosition) {
      const heart = {
        x: Math.random() * (canvas.width - 40),
        y: yPosition,
        collected: false
      };
      hearts.push(heart);
    }

    // Yeni platform ve kalp ekleme
    function updatePlatformsAndHearts() {
      if (Math.random() < 0.02) {
        createPlatform(-20);
        createHeart(-20);
      }
    }

    // Zeminleri çizme
    function drawPlatforms() {
      platforms.forEach((platform) => {
        ctx.fillStyle = "green";
        ctx.fillRect(platform.x, platform.y - offsetY, platform.width, platform.height);
      });
    }

    // Kalpleri çizme
    function drawHearts() {
      hearts.forEach((heart) => {
        if (!heart.collected) {
          ctx.fillStyle = "red";
          ctx.beginPath();
          ctx.moveTo(heart.x, heart.y - offsetY);
          ctx.bezierCurveTo(heart.x, heart.y - 10 - offsetY, heart.x - 10, heart.y - 10 - offsetY, heart.x - 10, heart.y + 5 - offsetY);
          ctx.bezierCurveTo(heart.x - 10, heart.y + 15 - offsetY, heart.x, heart.y + 20 - offsetY, heart.x, heart.y + 25 - offsetY);
          ctx.bezierCurveTo(heart.x, heart.y + 20 - offsetY, heart.x + 10, heart.y + 15 - offsetY, heart.x + 10, heart.y + 5 - offsetY);
          ctx.bezierCurveTo(heart.x + 10, heart.y - 10 - offsetY, heart.x, heart.y - 10 - offsetY, heart.x, heart.y - offsetY);
          ctx.fill();
        }
      });
    }

    // Karakterleri çizme
    function drawCharacter() {
      ctx.fillStyle = "blue";
      ctx.fillRect(character1.x, character1.y - offsetY, character1.width, character1.height);
      ctx.fillRect(character2.x, character2.y - offsetY, character2.width, character2.height);

      // Yüzleri çizme
      const face1 = document.getElementById("face1");
      const face2 = document.getElementById("face2");

      ctx.drawImage(face1, character1.x, character1.y - offsetY - 20, character1.width, character1.height);
      ctx.drawImage(face2, character2.x, character2.y - offsetY - 20, character2.width, character2.height);
    }

    // Yükseklik sınırı ve yerçekimi
    function updateCharacter() {
      character1.velY += gravity;
      character2.velY += gravity;

      character1.y += character1.velY;
      character2.y += character2.velY;

      character1.x += character1.velX;
      character2.x += character2.velX;

      // Sol sınır kontrolü
      if (character1.x < 0) {
        character1.x = 0;
      }
      if (character2.x < 0) {
        character2.x = 0;
      }

      // Sağ sınır kontrolü
      if (character1.x + character1.width > canvas.width) {
        character1.x = canvas.width - character1.width;
      }
      if (character2.x + character2.width > canvas.width) {
        character2.x = canvas.width - character2.width;
      }

      if (character1.y + character1.height > canvas.height) {
        character1.y = canvas.height - character1.height;
        character1.grounded = true;
        character1.velY = 0;
      }

      if (character2.y + character2.height > canvas.height) {
        character2.y = canvas.height - character2.height;
        character2.grounded = true;
        character2.velY = 0;
      }

      platforms.forEach((platform) => {
        if (
          character1.x + character1.width > platform.x &&
          character1.x < platform.x + platform.width &&
          character1.y + character1.height <= platform.y &&
          character1.y + character1.height + character1.velY >= platform.y
        ) {
          character1.y = platform.y - character1.height;
          character1.velY = 0;
          character1.grounded = true;
        }

        if (
          character2.x + character2.width > platform.x &&
          character2.x < platform.x + platform.width &&
          character2.y + character2.height <= platform.y &&
          character2.y + character2.height + character2.velY >= platform.y
        ) {
          character2.y = platform.y - character2.height;
          character2.velY = 0;
          character2.grounded = true;
        }
      });

      // Kalp toplayıp toplamadığını kontrol et
      hearts.forEach((heart) => {
        if (!heart.collected && character1.x + character1.width > heart.x && character1.x < heart.x + 40 && character1.y + character1.height > heart.y) {
          heart.collected = true;
          score++;
        }
        if (!heart.collected && character2.x + character2.width > heart.x && character2.x < heart.x + 40 && character2.y + character2.height > heart.y) {
          heart.collected = true;
          score++;
        }
      });
    }

    // Platformları aşağıya kaydırma
    function movePlatforms() {
      platforms.forEach((platform) => {
        platform.y += 2;
      });
      hearts.forEach((heart) => {
        heart.y += 2;
      });

      // Yeni platformlar ve kalpler ekleme
      updatePlatformsAndHearts();
    }

    // Skor ve can göstergesi
    function drawUI() {
      ctx.fillStyle = "black";
      ctx.font = "24px Arial";
      ctx.fillText(`Skor: ${score}`, 30, 30);
      ctx.fillText(`Canlar: ${lives}`, 30, 60);
    }

    // Ekran kaydırma işlemi
    function moveScreenUp() {
      offsetY += 2;
    }

    // Oyun döngüsü
    function gameLoop() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      updateCharacter();
      movePlatforms();
      drawCharacter();
      drawPlatforms();
      drawHearts();
      drawUI();

      if (moveLeft) {
        character1.velX = -character1.speed;
        character2.velX = -character2.speed;
      } else if (moveRight) {
        character1.velX = character1.speed;
        character2.velX = character2.speed;
      } else {
        character1.velX = 0;
        character2.velX = 0;
      }

      if (character1.y > canvas.height || character2.y > canvas.height) {
        lives--;
        if (lives <= 0) {
          alert("Game Over!");
          location.reload();
        } else {
          character1.y = canvas.height - 150;
          character1.velY = 0;
          character2.y = canvas.height - 150;
          character2.velY = 0;
        }
      }

      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>
