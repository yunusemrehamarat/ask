<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Kalp Toplama Oyunu</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    body, html {
      width: 100%;
      height: 100%;
      overflow: hidden;
      position: fixed;
      touch-action: none;
      background-color: #f5f5f5;
      font-family: Arial, sans-serif;
    }
    
    canvas {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
    }
    
    #leftButton, #rightButton {
      position: fixed;
      bottom: 20px;
      width: 40%;
      height: 80px;
      background-color: rgba(0,0,0,0.2);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 36px;
      user-select: none;
      -webkit-user-select: none;
      z-index: 5;
    }
    
    #leftButton {
      left: 5%;
    }
    
    #rightButton {
      right: 5%;
    }
    
    #gameOverScreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 24px;
      z-index: 10;
    }
    
    #restartButton {
      margin-top: 40px;
      padding: 15px 30px;
      background-color: #e74c3c;
      border: none;
      border-radius: 5px;
      color: white;
      font-size: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>
  
  <div id="leftButton">←</div>
  <div id="rightButton">→</div>
  
  <div id="gameOverScreen">
    <h1>Süre Doldu!</h1>
    <p id="finalScore">Skorunuz: 0</p>
    <button id="restartButton">Tekrar Oyna</button>
  </div>

  <script>
    // Oyun değişkenleri
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const gameOverScreen = document.getElementById("gameOverScreen");
    const finalScore = document.getElementById("finalScore");
    const restartButton = document.getElementById("restartButton");
    
    let gameWidth, gameHeight;
    let score = 0;
    let timer = 60;
    let gameActive = false;
    let timerInterval;
    let moveLeft = false;
    let moveRight = false;
    
    // Görsel değişkenler
    const heartSize = 30;
    const characterSize = 40;
    let hearts = [];
    
    // Karakter pozisyonu
    let character = {
      x: 0,
      y: 0,
      width: characterSize * 2 + 10, // İki karakter genişliği + biraz boşluk
      speed: 7
    };
    
    // Oyun başlatma
    function initGame() {
      // Ekran boyutlarını al
      updateScreenSize();
      
      // Karakter başlangıç pozisyonu
      character.x = gameWidth / 2 - character.width / 2;
      character.y = gameHeight - characterSize - 100; // Alt kısımdan biraz yukarıda
      
      // Oyun değişkenlerini sıfırla
      score = 0;
      timer = 60;
      hearts = [];
      
      // Oyunu başlat
      gameActive = true;
      gameOverScreen.style.display = "none";
      
      // Zamanlayıcıyı başlat
      clearInterval(timerInterval);
      timerInterval = setInterval(function() {
        timer--;
        if (timer <= 0) {
          endGame();
        }
      }, 1000);
    }
    
    // Ekran boyutlarını güncelle
    function updateScreenSize() {
      gameWidth = window.innerWidth;
      gameHeight = window.innerHeight;
      
      canvas.width = gameWidth;
      canvas.height = gameHeight;
      
      // Karakterin dikey pozisyonunu güncelle
      if (character.y) {
        character.y = gameHeight - characterSize - 100;
      }
      
      // Buton boyutlarını ayarla
      const leftButton = document.getElementById("leftButton");
      const rightButton = document.getElementById("rightButton");
      
      // Mobil cihazlarda butonları daha büyük yap
      const buttonHeight = Math.min(80, gameHeight * 0.12);
      leftButton.style.height = buttonHeight + "px";
      rightButton.style.height = buttonHeight + "px";
      
      // Buton pozisyonlarını ayarla
      leftButton.style.bottom = (gameHeight * 0.05) + "px";
      rightButton.style.bottom = (gameHeight * 0.05) + "px";
    }
    
    // Oyun döngüsü
    function gameLoop() {
      // Ekranı temizle
      ctx.clearRect(0, 0, gameWidth, gameHeight);
      
      // Arka plan
      ctx.fillStyle = "#f5f5f5";
      ctx.fillRect(0, 0, gameWidth, gameHeight);
      
      if (gameActive) {
        // Karakteri hareket ettir
        updateCharacter();
        
        // Kalpleri güncelle
        updateHearts();
        
        // Çizim
        drawCharacter();
        drawHearts();
      }
      
      // Her durumda UI çiz
      drawUI();
      
      requestAnimationFrame(gameLoop);
    }
    
    // Karakteri güncelle
    function updateCharacter() {
      // Karakter hareketlerini yönet
      if (moveLeft) {
        character.x -= character.speed;
      }
      if (moveRight) {
        character.x += character.speed;
      }
      
      // Ekran sınırları kontrolü
      if (character.x < 0) {
        character.x = 0;
      }
      if (character.x + character.width > gameWidth) {
        character.x = gameWidth - character.width;
      }
    }
    
    // Kalpleri güncelle
    function updateHearts() {
      // Yeni kalp oluşturma olasılığı
      if (Math.random() < 0.03) {
        createHeart();
      }
      
      // Kalpleri hareket ettir ve çarpışmaları kontrol et
      for (let i = hearts.length - 1; i >= 0; i--) {
        const heart = hearts[i];
        heart.y += heart.speed;
        
        // Karakter ile kalp çarpışma kontrolü
        if (heart.y + heartSize > character.y && 
            heart.y < character.y + characterSize &&
            heart.x + heartSize > character.x && 
            heart.x < character.x + character.width) {
          // Kalbi kaldır ve skoru artır
          hearts.splice(i, 1);
          score++;
        }
        
        // Ekran dışına çıkan kalpleri kaldır
        if (heart.y > gameHeight) {
          hearts.splice(i, 1);
        }
      }
    }
    
    // Yeni kalp oluştur
    function createHeart() {
      const heart = {
        x: Math.random() * (gameWidth - heartSize),
        y: -heartSize,
        speed: 2 + Math.random() * 3 // Farklı hızlarda düşmesi için
      };
      hearts.push(heart);
    }
    
    // Kız karakterini çiz
    function drawGirl(x, y, size) {
      // Yüz
      ctx.fillStyle = "#FFCBC4"; // Açık ten rengi
      ctx.beginPath();
      ctx.arc(x + size/2, y + size/2, size/2 - 2, 0, Math.PI * 2);
      ctx.fill();
      
      // Saç
      ctx.fillStyle = "#8A4F40"; // Kahverengi saç
      ctx.beginPath();
      ctx.ellipse(x + size/2, y + size/3, size/2, size/3, 0, 0, Math.PI * 2);
      ctx.fill();
      
      // Gözler
      ctx.fillStyle = "black";
      ctx.beginPath();
      ctx.arc(x + size/3, y + size/2, size/10, 0, Math.PI * 2);
      ctx.arc(x + size*2/3, y + size/2, size/10, 0, Math.PI * 2);
      ctx.fill();
      
      // Gülümseyen ağız
      ctx.beginPath();
      ctx.arc(x + size/2, y + size*3/5, size/6, 0, Math.PI);
      ctx.stroke();
      
      // Elbise
      ctx.fillStyle = "#FF69B4"; // Pembe
      ctx.beginPath();
      ctx.arc(x + size/2, y + size, size/2, Math.PI, Math.PI * 2);
      ctx.fill();
    }
    
    // Erkek karakterini çiz
    function drawBoy(x, y, size) {
      // Yüz
      ctx.fillStyle = "#FFD8B1"; // Açık ten rengi
      ctx.beginPath();
      ctx.arc(x + size/2, y + size/2, size/2 - 2, 0, Math.PI * 2);
      ctx.fill();
      
      // Saç
      ctx.fillStyle = "#2C2C2C"; // Siyah saç
      ctx.beginPath();
      ctx.arc(x + size/2, y + size/3, size/2.5, 0, Math.PI);
      ctx.fill();
      
      // Gözler
      ctx.fillStyle = "black";
      ctx.beginPath();
      ctx.arc(x + size/3, y + size/2, size/10, 0, Math.PI * 2);
      ctx.arc(x + size*2/3, y + size/2, size/10, 0, Math.PI * 2);
      ctx.fill();
      
      // Gülümseyen ağız
      ctx.beginPath();
      ctx.arc(x + size/2, y + size*3/5, size/6, 0, Math.PI);
      ctx.stroke();
      
      // Kıyafet
      ctx.fillStyle = "#4169E1"; // Mavi
      ctx.beginPath();
      ctx.arc(x + size/2, y + size, size/2, Math.PI, Math.PI * 2);
      ctx.fill();
    }
    
    // Karakteri çiz
    function drawCharacter() {
      // Kız karakteri
      drawGirl(character.x, character.y, characterSize);
      
      // Erkek karakteri
      drawBoy(character.x + characterSize + 10, character.y, characterSize);
    }
    
    // Kalpleri çiz
    function drawHearts() {
      hearts.forEach(heart => {
        // Kalp çizimi
        ctx.fillStyle = "#e74c3c";
        ctx.beginPath();
        const centerX = heart.x + heartSize/2;
        const centerY = heart.y + heartSize/2;
        
        // Kalp şekli
        ctx.moveTo(centerX, centerY - heartSize/4);
        ctx.bezierCurveTo(
          centerX - heartSize/2, centerY - heartSize/2,
          centerX - heartSize/2, centerY + heartSize/4,
          centerX, centerY + heartSize/2
        );
        ctx.bezierCurveTo(
          centerX + heartSize/2, centerY + heartSize/4,
          centerX + heartSize/2, centerY - heartSize/2,
          centerX, centerY - heartSize/4
        );
        ctx.fill();
      });
    }
    
    // Arayüzü çiz
    function drawUI() {
      // Skor ve zamanlayıcı arka planı
      ctx.fillStyle = "rgba(0,0,0,0.5)";
      ctx.fillRect(0, 0, gameWidth, 50);
      
      // Skor
      ctx.fillStyle = "white";
      ctx.font = "bold 24px Arial";
      ctx.textAlign = "left";
      ctx.fillText(`Skor: ${score}`, 20, 33);
      
      // Zamanlayıcı
      ctx.fillStyle = "white";
      ctx.font = "bold 24px Arial";
      ctx.textAlign = "right";
      ctx.fillText(`Süre: ${timer}`, gameWidth - 20, 33);
    }
    
    // Oyunu bitir
    function endGame() {
      gameActive = false;
      clearInterval(timerInterval);
      finalScore.textContent = `Skorunuz: ${score}`;
      gameOverScreen.style.display = "flex";
    }
    
    // Pencere boyutu değiştiğinde
    window.addEventListener("resize", function() {
      updateScreenSize();
    });
    
    // Mobil kontroller
    document.getElementById("leftButton").addEventListener("touchstart", function(e) {
      e.preventDefault();
      moveLeft = true;
    }, { passive: false });
    
    document.getElementById("leftButton").addEventListener("touchend", function(e) {
      e.preventDefault();
      moveLeft = false;
    }, { passive: false });
    
    document.getElementById("rightButton").addEventListener("touchstart", function(e) {
      e.preventDefault();
      moveRight = true;
    }, { passive: false });
    
    document.getElementById("rightButton").addEventListener("touchend", function(e) {
      e.preventDefault();
      moveRight = false;
    }, { passive: false });
    
    // Fare kontrolleri
    document.getElementById("leftButton").addEventListener("mousedown", function() {
      moveLeft = true;
    });
    
    document.getElementById("leftButton").addEventListener("mouseup", function() {
      moveLeft = false;
    });
    
    document.getElementById("leftButton").addEventListener("mouseleave", function() {
      moveLeft = false;
    });
    
    document.getElementById("rightButton").addEventListener("mousedown", function() {
      moveRight = true;
    });
    
    document.getElementById("rightButton").addEventListener("mouseup", function() {
      moveRight = false;
    });
    
    document.getElementById("rightButton").addEventListener("mouseleave", function() {
      moveRight = false;
    });
    
    // Klavye kontrolleri
    window.addEventListener("keydown", function(e) {
      if (e.key === "ArrowLeft") {
        moveLeft = true;
      } else if (e.key === "ArrowRight") {
        moveRight = true;
      }
    });
    
    window.addEventListener("keyup", function(e) {
      if (e.key === "ArrowLeft") {
        moveLeft = false;
      } else if (e.key === "ArrowRight") {
        moveRight = false;
      }
    });
    
    // Oyunu yeniden başlat butonu
    restartButton.addEventListener("click", function() {
      initGame();
    });
    
    // Sayfa yüklendiğinde oyunu başlat
    window.onload = function() {
      initGame();
      gameLoop();
    };
  </script>
</body>
</html>
